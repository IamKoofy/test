- name: Parse namespaces JSON and extract names
      set_fact:
        namespaces: "{{ namespaces_json.stdout | from_json | json_parse }}"
      when: oc_login_result.rc == 0

    - name: Loop through each namespace
      include_tasks: backup_namespace.yml
      loop: "{{ namespaces }}"
      loop_control:
        loop_var: namespace
      when: oc_login_result.rc == 0

  vars:
    json_parse: >
      {{
        namespaces_json.stdout | from_json | dict2items | selectattr('key', 'equalto', 'items') | map(attribute='value') | map('extract', attribute='metadata.name')
      }}
Explanation
